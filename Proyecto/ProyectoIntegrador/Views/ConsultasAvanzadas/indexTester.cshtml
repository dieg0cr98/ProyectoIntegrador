<style>
    body {
        font-family: "Lato", sans-serif;
        width: 100%;
        height: 100%;
    }

    .sidenav {
        max-height: 790px;
        width: 0;
        position: fixed;
        z-index: 1;
        top: 156px;
        left: 0;
        background-color: #76323F;
        overflow-x: hidden;
        transition: 0.5s;
        padding-top: 0px;
    }

        .sidenav a {
            padding: 8px 8px 8px 32px;
            text-decoration: none;
            font-size: 25px;
            color: #FFFFFF;
            display: block;
            transition: 0.3s;
        }

            .sidenav a:hover {
                color: #C09F80;
            }

        .sidenav .closebtn {
            position: absolute;
            top: 0;
            right: 25px;
            font-size: 36px;
            margin-left: 50px;
        }

    #main {
        transition: margin-left .5s;
        padding: 16px;
    }

    .table-row {
        cursor: pointer;
    }
</style>

<body onload="cargarProyectoGraph(@ViewBag.datosTester.Item1)">

    </br>
    </br>
    </br>

    <h2 class="text-primary text-center font-weight-bold">Nombre Tester: @ViewBag.datosTester.Item2</h2>
    </br>
    </br>


    <div class="row">

        <div class="col">
            <table class="table table-bordered table-hover table-light">
                <thead class="thead-dark">
                    <tr>
                        <th scope="col">Nombre Proyecto</th>
                        <th scope="col">Horas Dedicadas</th>
                    </tr>
                </thead>
                <tbody>


                    @foreach (var tupla in ViewBag.listaProyectos)
                    {

                        <tr class="table-row" onclick="cargarRequerimientos(@tupla.idProyectoAID,@ViewBag.datosTester.Item1)">
                            <th scope="row">@tupla.nombre</th>
                            <td>@tupla.horas</td>

                        </tr>

                    }

                </tbody>
            </table>
        </div>

        <div class="col" id="graphProyecto">

            <div id="timeline"></div>


        </div>

    </div>


    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>


    <script>

        function cargarProyectoGraph(cedulaTester) {
            //Pide los datos al controlador
            $.ajax({
                url: "/ConsultasAvanzadas/consulta6Proyecto",
                method: "GET",
                data: {
                    cedulaTester: function () {
                        return cedulaTester;
                    },

                },
                success: function (data) {

                    data2 = JSON.parse(data);
                    
                     //Carga los datos del chart
                    google.charts.load("visualization", "1", { packages: ["timeline"] }
                    ).then(function () {
                    // Define the chart to be drawn.
                    var data = new google.visualization.DataTable();
                    data.addColumn({ type: 'string', id: 'Proyecto:' });
                    data.addColumn({ type: 'date', id: 'Inicio' });
                    data.addColumn({ type: 'date', id: 'Fin' });


                    for (tupla in data2) {

                        var nombre = data2[tupla].nombre;
   
                        var fechaInicio = data2[tupla].fechaInicio;
                        var fechaFin = data2[tupla].fechaFin;
                        

                        data.addRow([nombre, new Date(fechaInicio.substring(0, 4),fechaInicio.substring(5, 7),fechaInicio.substring(8, 10)), new Date(fechaFin.substring(0, 4),fechaFin.substring(5, 7),fechaFin.substring(8, 10))]);

                    }


                    var options = {      
                       width: '100%', 
                       height: '100%'
                    };
                  
                    // Instantiate and draw the chart.
                    var chart = new google.visualization.Timeline(document.getElementById('timeline'));
                    chart.draw(data, options);

                    });
                  


                }
                ,
                error: function (err) {
                    alert("Ha ocurrido un error");
                }


            });

        }


        function cargarRequerimientos(idProyecto, cedulaTester) {
            alert(idProyecto + " " + cedulaTester);
        }

    </script>

</body>



