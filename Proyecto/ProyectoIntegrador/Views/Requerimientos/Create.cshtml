@model ProyectoIntegrador.BaseDatos.Requerimiento

@{
    ViewBag.Title = "Create";
}



    <head>
        <script src="https://code.jquery.com/jquery-1.11.1.min.js"></script>
        <script src="https://cdn.jsdelivr.net/jquery.validation/1.16.0/jquery.validate.min.js"></script>
        <script src="https://cdn.jsdelivr.net/jquery.validation/1.16.0/additional-methods.min.js"></script>

        <!-- Se define la letra y los estilos para el error y los por defecto -->
        <style>

            .error {
                color: white;
                background-color: red;
                font-family: verdana, Helvetica;
            }

            input.error, input select.error {
                background-color: white;
                border-color: red;
            }
        </style>
    </head>



    <body>
        <p class="font-weight-bold text-center" style="font-family:PlayfairDisplay-Bold; font-size:50px ; letter-spacing: 5px">Agregar Requerimientos</p>
        <hr>

        <!-- Se crea el formulario con el que recibiremos los datos -->
        <form class="cmxform" id="commentForm" method="post" action="Create">
            <fieldset>
                <div class="container justify-content-center bg-secondary" style="width:800px; border-radius:25px; box-shadow: 1px 9px 22px 12px  rgba(128,128,128,0.91)">

                    <!-- Si hay un error se despliega -->
                    @if (ViewBag.error != null)
                    {
                        <div class="alert alert-primary text-center m-3 pt-2" style="color:white;  border-radius:25px ; border-color:transparent ; background-color:red; height:50px">@ViewBag.error</div>
                    }
                    else
                    {
                        <div class="alert alert-primary text-center m-3 pt-2" style=" border-color:transparent ; background-color:transparent; height:50px"></div>

                    }

                    <!--Se pasa el id del proyecto asociado y del requerimiento de manera oculta ya que al usuario no le interesa esto-->
                    <input type="hidden" id="custId" name="idProyecto" value=@ViewBag.idProyectoFK>
                    <input type="hidden" id="custId" name="idRequerimiento" value=@ViewBag.nuevoIDRequerimiento>

                    @*Titulo de Atributo Descripción*@
                    <div class="form-row">
                        <div class="col">
                            <h5> Descripción</h5>
                        </div>
                    </div>

                    @*Atributo descripcion*@
                    <div class="input-group mb-4  mx-6">
                        <textarea class="form-control" name="descripcion" placeholder="Max 100 caracteres" maxlength="100" aria-label="With textarea" style="max-width:none" id="comment"></textarea>
                    </div>

                    <div class="form-row">
                        @*Título de Atributo Complejidad*@
                        <div class="col-3 ">
                            <h5> Complejidad </h5>
                        </div>

                        <div class="col-3">

                        </div>

                        @*Título de Atributo Estado*@
                        <div class="col-3">
                            <h5> Estado </h5>
                        </div>
                    </div>

                    <div class="form-row mb-4">
                        <div class="col-3">
                            @*Atributo Complejidad*@
                            <div class="input-group">
                                <select class="custom-select" name="complejidad">
                                    <option value="Simple">Simple</option>
                                    <option value="Medio" selected>Medio</option>
                                    <option value="Complejo">Complejo</option>
                                    <option value="Muy Complejo">Muy Complejo</option>
                                </select>
                            </div>
                        </div>

                        <div class="col-3">

                        </div>

                        <div class="col-3">

                            @*Atributo Estado*@
                            <div class="input-group">
                                <select class="custom-select" name="estado">
                                    <option value="Activo">Activo</option>
                                    <option value="Preparacion" selected>Preparación</option>
                                    <option value="Terminado">Terminado</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <div class="form-row">
                        @*Título de Atributo cedulaTesterFK*@
                        <div class="col-4">
                            <h5> Asignar tester </h5>
                        </div>

                        <div class="col-2">

                        </div>
                        @*Título de atributo cedulaTesterFK*@
                        <div class="col-3">
                            <h5> Nombre del Requerimiento </h5>
                        </div>
                    </div>

                    <div class="form-row mb-4">
                        
                        <div class="col-4">
                            @*Atributo Cédula Tester*@
                           <div class="input-group">
                               <select class="custom-select" name="estado">
                                   <option value="null" selected>No Asignar</option>
                                   @foreach (var item in ViewBag.TestersDisponibles)
                                   {
                                       <option value="item.idEmpleadoPK">item.nombre item.apellido1 item.apellido2</option>
                                   }
                               </select>
                            </div>
                        </div>

                        <div class="col-2">

                        </div>
                        
                        <div class="col-3">
                            @*Atributo nombre*@
                            <div class="input-group">
                                <input id="nom" class="form-control" placeholder="Ingrese el Nombre" style="text-align:center" name="nombre" minlength="1" maxlength="40" type="text" required>
                            </div>
                            <div id="errorNombre"></div>
                        </div>
                    </div>

                    <div class="form-row">
                        @*Título de Atributo Duracion Estimada*@
                        <div class="col-4 ">
                            <h5> Duración Estimada </h5>
                        </div>

                        <div class="col-2 ">

                        </div>

                        @*Título de Atributo Fecha de Inicio*@
                        <div class="col-4 ">
                            <h5> Fecha de Inicio </h5>
                        </div>
                    </div>

                    <div class="form-row mb-2">
                        <div class="col-2">

                            @*Atributo duracionEstimada*@
                            <div class="input-group">
                                <input id="de" class="form-control" type="number" style=" text-align:center" name="duracionEstimada" required>
                            </div>
                            <small class="form-text text-center" style="color:black">Formato en cantidad de horas</small>
                            <div id="errorDuracionEstimada"></div>
                        </div>

                        <div class="col-4">

                        </div>

                        <div class="col-3">
                            @*Atributo fechaInicio*@
                            <div class="input-group">
                                <input id="cfecha" class="form-control text-center" type="date" name="fechai" required>
                            </div>
                            <div id="errorFechai"></div>
                        </div>
                    </div>

                    <h5> * Campos requeridos</h5>

                    <hr />

                    <div class="row justify-content-center" style="max-width:1150px">
                        <div class="col-4  text-center">
                            <a onclick="my_loading(this,'80px','80px')" data-toggle="tooltip" data-placement="left" title="Cancelar" class="btn d-inline-block" href="@Url.Action("Index", "Requerimientos", new { idProyecto = ViewBag.idProyectoFK })"><img src="~/Content/cancelar.svg" class="rounded float-right" style="height:80px ; width:80px"></a>
                        </div>
                        <div class="col-4  text-center">

                            <button onclick="my_loading(this,'80px','80px')" type="submit" class="btn btn-default" value="Submit" data-toggle="tooltip" data-placement="top" title="Aceptar">
                                <img src="~/Content/aceptar.svg" class="rounded float-right" style="height:80px ; width:80px">
                            </button>
                        </div>
                    </div>


                </div>
            </fieldset>
        </form>




        <script>

            $('document').ready(function () {


                $('#loading').hide();



            });



            $('#btnsubmit').on('click', function () {
                $('#acceptar').hide('fast');


                $('#loading').show('fast');


            });

        </script>



        <script>
            $(function () {
                $("#commentForm").validate(
                    {
                        rules:
                        {
                            nombre:
                            {
                                required: true,
                                minlength: 1

                            },
                            duracionEstimada:
                            {
                                required: true,
                                min: 1

                            },
                            fechai:
                            {
                                required: true,

                            },

                        },
                        messages:
                        {
                            nombre: "Inserte al menos 1 caracter",
                            duracionEstimada: "Tiene que ser un numero mayor a 0",
                            fechai: "Inserte una fecha"

                        },

                        errorPlacement: function (error, element) {
                            if ((element.attr('name') === 'nombre')) {
                                error.insertAfter($('#errorNombre'));
                            }
                            if ((element.attr('name') === 'fechai')) {
                                error.insertAfter($('#errorFechai'));
                            }
                            if ((element.attr('name') === 'duracionEstimada')) {
                                error.insertAfter($('#errorDuracionEstimada'));
                            }





                        },
                        invalidHandler: function (form, validator) {

                            $('#loading').hide('fast');
                            $('#acceptar').show('fast');

                        },



                    });
            });
        </script>
        <script>
            $(function () {
                $('[data-toggle="tooltip"]').tooltip()
            })
        </script>
    </body>